# Frontend Environment Configuration

## Environment Files

This project uses different environment files for different stages:

### `.env.example`
Template file showing all available environment variables. **Do not edit this file directly.**

### `.env.development`
Used when running `npm run dev` (local development)

### `.env.production`
Used when running `npm run build` (production build)

---

## Setup Instructions

### For Local Development

1. **Copy the example file:**
   ```bash
   cp .env.example .env.development
   ```

2. **Edit `.env.development`:**
   ```env
   # Leave empty to use Vite proxy (recommended for local dev)
   VITE_API_URL=

   # OR use direct connection:
   # VITE_API_URL=http://localhost:3006
   ```

3. **Start development server:**
   ```bash
   npm run dev
   ```

---

### For Production Build

1. **Copy the example file:**
   ```bash
   cp .env.example .env.production
   ```

2. **Edit `.env.production`:**
   ```env
   # Use your actual backend domain
   VITE_API_URL=https://apivkq.softodoor.com
   ```

3. **Build for production:**
   ```bash
   npm run build
   ```

---

## Environment Variables

### `VITE_API_URL`

The base URL for your backend API.

**Development:**
- Leave empty (`VITE_API_URL=`) to use Vite's proxy configuration
- Vite will proxy `/api/*` requests to `http://localhost:3006`

**Production:**
- Set to your backend domain: `VITE_API_URL=https://apivkq.softodoor.com`
- Frontend will make direct requests to this URL

---

## Current Configuration

### Development
- File: `.env.development`
- Backend: `http://localhost:3006` (via Vite proxy)
- Command: `npm run dev`

### Production
- File: `.env.production`
- Backend: `https://apivkq.softodoor.com`
- Command: `npm run build`

---

## Important Notes

1. **Environment files are loaded automatically** based on the mode:
   - `npm run dev` → Loads `.env.development`
   - `npm run build` → Loads `.env.production`

2. **All Vite env variables must start with `VITE_`**
   - ✅ `VITE_API_URL` - Accessible in code
   - ❌ `API_URL` - NOT accessible in code

3. **Rebuild required after changes:**
   - Changing `.env.production` requires rebuilding: `npm run build`
   - Changing `.env.development` requires restarting: Stop and `npm run dev` again

4. **Security:**
   - Never commit actual `.env.development` or `.env.production` files with secrets
   - Only commit `.env.example` as a template

---

## Accessing Environment Variables in Code

```javascript
// In any React component or JS file:
const apiUrl = import.meta.env.VITE_API_URL;

console.log(apiUrl);
// Development: "" (empty, uses proxy)
// Production: "https://apivkq.softodoor.com"
```

---

## Using the API Utility

Instead of manually concatenating URLs, use the API utility:

```javascript
import { apiGet, apiPost } from './utils/api';

// The utility handles the base URL automatically
const response = await apiGet('/api/clients');
const data = await response.json();
```

The API utility (`src/utils/api.js`) automatically uses `VITE_API_URL` from your environment.

---

## Troubleshooting

### API calls fail in development
- Check if backend is running on port 3006
- Verify Vite proxy configuration in `vite.config.js`
- Check browser console for CORS errors

### API calls fail in production
- Verify `VITE_API_URL` in `.env.production`
- Rebuild frontend after changing `.env.production`
- Check backend CORS allows your frontend domain
- Verify backend is accessible at the specified URL

### Environment variable is undefined
- Ensure variable name starts with `VITE_`
- Restart dev server after adding new variables
- Rebuild if in production mode

---

## Example: Complete Setup

```bash
# 1. Copy example file
cp .env.example .env.development

# 2. (Optional) Edit if needed - by default it uses Vite proxy

# 3. Install dependencies
npm install

# 4. Start development server
npm run dev

# 5. For production, create .env.production
cp .env.example .env.production

# 6. Edit .env.production with production backend URL
echo "VITE_API_URL=https://apivkq.softodoor.com" > .env.production

# 7. Build for production
npm run build

# 8. Upload 'dist' folder to Plesk
```

---

## File Structure

```
frontend/
├── .env.example          # Template (commit to git)
├── .env.development      # Local dev (DO NOT commit)
├── .env.production       # Production (DO NOT commit)
├── vite.config.js        # Vite configuration
├── src/
│   ├── config/
│   │   └── api.js        # API URL helper
│   └── utils/
│       └── api.js        # API fetch utilities
└── README_ENV.md         # This file
```
